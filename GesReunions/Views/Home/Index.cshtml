

@{
    ViewBag.Title = "Home Page";
    Layout = "~/Views/Shared/_test.cshtml";
}
<style>


    .row {
        display: flex;
        justify-content: center; /* Centre les cartes horizontalement */
        gap: 20px; /* Espace entre les cartes */
    }

    .col {
        flex: 1; /* Permet aux colonnes de s'ajuster en largeur */
        max-width: 300px; /* Limite la largeur maximale de chaque carte */
    }

    .info-stats4 {
        border: 1px solid #ddd; /* Bordure pour visualiser les cartes */
        padding: 20px;
        text-align: center;
        background-color: #fff;
        border-radius: 8px;
    }

    .info-icon {
        font-size: 24px;
        margin-bottom: 10px;
    }

    .sale-num h3 {
        margin: 0;
        font-size: 28px;
    }

    .sale-num p {
        margin: 0;
        font-size: 16px;
        color: #666;
    }
</style>
<!-- Row start -->

<div class="row gutters">
    <div class="col">
        <div class="info-stats4">
            <div class="info-icon">
                <i class="fas fa-calendar-day"></i>
            </div>
            <div class="sale-num">
                <h3>@Model.NombreDeReunions</h3>
                <p>Les Reunions</p>
            </div>
        </div>
    </div>
    <div class="col">
        <div class="info-stats4">
            <div class="info-icon">
                <i class="fas fa-user"></i>
            </div>
            <div class="sale-num">
                <h3>@Model.NombreDUtilisateurs</h3>
                <p>Les employées</p>
            </div>
        </div>
    </div>
    <div class="col">
        <div class="info-stats4">
            <div class="info-icon">
                <i class="fas fa-building"></i>
            </div>
            <div class="sale-num">
                <h3>@Model.NombreDeSalles</h3>
                <p>les Salles</p>
            </div>
        </div>
    </div>
</div>


<!-- Row end -->
<!-- Row start -->
<div class="row gutters">
    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
        <div class="card">
            <div class="card-header">
                <div class="card-title">Reunions</div>
            </div>
            <div class="card-body pt-0">
                <div id="visitors"></div>
            </div>
        </div>
    </div>
</div>

<!-- Row end -->
<!-- Row start -->
<div class="row gutters">
    <div class="col-xl-4 col-lg-6 col-md-6 col-sm-12 col-12">
        <div class="card">
            <div class="card-header">
                <div class="card-title">Proportion des Salles par Rapport aux Réunions</div>
            </div>
            <br />
            <br />
            <div class="card-body">
                <div id="customers"></div>

            </div>

            <br />
            <br />

        </div>
    </div>
    <div class="col-xl-4 col-lg-12 col-md-12 col-sm-12 col-12">
        <div class="card">
            <div class="card-header">
                <div class="card-title">Nombre des Reunions</div>
            </div>
            <div class="card-body">
                <div class="customScroll5">

                    <div id="room-stats-container">
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
<!-- Row end -->

@section Scripts {
    <script>
        $(document).ready(function () {
        $.ajax({
        url: '@Url.Action("GetMeetingDistribution", "Reunions")',
        type: 'GET',
        success: function(data) {
            var options = {
                chart: {
                    height: 193,
                    type: 'donut',
                },
                labels: data.map(function(item) { return item.Room; }),
                legend: {
                    show: false,
                },
                series: data.map(function(item) { return item.Count; }),
                stroke: {
                    width: 1,
                },
                colors: ['#ee0000', '#999999', '#ffcc00', '#00cc99', '#6633ff'],
            };

            var chart = new ApexCharts(
                document.querySelector("#customers"),
                options
            );

            chart.render();

            // Remplir les informations des salles
            var roomStatsContainer = document.getElementById("room-stats-container");
            data.forEach(function(item, index) {
                var roomStatsHtml = `

                 <div class="activity-logs" style="font-family: Arial, sans-serif;">
    <div class="activity-log-list" style="display: flex; align-items: center;">
        <div class="sts" style="margin-right: 10px;"></div>
        <span class="room-name" style="font-size: 15px; font-weight: bold; margin-right: 10px;">
            ${item.Room} :
        </span>
        <span class="room-count" style="font-size: 14px;">
            ${item.Count}
        </span>
    </div>
</div>


                `;
                roomStatsContainer.innerHTML += roomStatsHtml;
            });
        }
    });
        $.ajax({
            url: '@Url.Action("GetReunionStats", "Reunions")',
            type: 'GET',
            success: function (data) {
                var options = {
                    chart: {
                        height: 280,
                        type: 'bar',
                        stacked: true,
                        toolbar: {
                            show: false
                        },
                        zoom: {
                            enabled: true
                        }
                    },
                    plotOptions: {
                        bar: {
                            horizontal: false,
                            columnWidth: '30%',
                        },
                    },
                    dataLabels: {
                        enabled: true
                    },
                    series: [{
                        name: 'Upcoming',
                        data: data.upcoming
                    }, {
                        name: 'Expired',
                        data: data.expired
                    }],
                    xaxis: {
                        type: 'category',
                        categories: data.months,
                    },
                    legend: {
                        offsetY: -7
                    },
                    fill: {
                        opacity: 1
                    },
                    colors: ['#ee0000', '#999999'],
                    tooltip: {
                        y: {
                            formatter: function (val) {
                                return "Meetings: " + val;
                            }
                        }
                    },
                };

                var chart = new ApexCharts(
                    document.querySelector("#visitors"),
                    options
                );

                chart.render();
            }
        });



    });

    </script>


}
